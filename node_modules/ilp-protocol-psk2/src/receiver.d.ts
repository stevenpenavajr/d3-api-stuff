/// <reference types="node" />
import BigNumber from 'bignumber.js';
import { PluginV1, PluginV2 } from 'ilp-compat-plugin';
import IlpPacket = require('ilp-packet');
export interface RequestHandler {
    (params: RequestHandlerParams): any;
}
export interface RequestHandlerParams {
    keyId?: Buffer;
    isFulfillable: boolean;
    amount: BigNumber;
    data: Buffer;
    accept: (responseData?: Buffer) => void;
    reject: (responseData?: Buffer) => void;
}
export interface PaymentHandler {
    (params: PaymentHandlerParams): void | Promise<void>;
}
export interface PaymentHandlerParams {
    id: Buffer;
    expectedAmount: string;
    accept: () => Promise<PaymentReceived>;
    reject: (message: string) => void;
    acceptSingleChunk: () => void;
    rejectSingleChunk: (message: string) => void;
    prepare: IlpPacket.IlpPrepare;
}
export interface PaymentReceived {
    id: Buffer;
    receivedAmount: string;
    expectedAmount: string;
    chunksFulfilled: number;
}
export interface ReceiverOpts {
    plugin: PluginV2 | PluginV1;
    paymentHandler?: PaymentHandler;
    requestHandler?: RequestHandler;
    secret?: Buffer;
}
export declare class Receiver {
    protected plugin: PluginV2;
    protected secret: Buffer;
    protected requestHandler: RequestHandler;
    protected paymentHandler: PaymentHandler;
    protected address: string;
    protected payments: Object;
    protected connected: boolean;
    protected usingRequestHandlerApi: boolean;
    protected specificRequestHandlers: {
        [key: string]: {
            sharedSecret: Buffer;
            requestHandler: RequestHandler;
        };
    };
    constructor(plugin: PluginV2 | PluginV1, secret: Buffer);
    connect(): Promise<void>;
    disconnect(): Promise<void>;
    isConnected(): boolean;
    registerRequestHandler(handler: RequestHandler): void;
    deregisterRequestHandler(): void;
    registerPaymentHandler(handler: PaymentHandler): void;
    deregisterPaymentHandler(): void;
    generateAddressAndSecret(keyId?: Buffer): {
        destinationAccount: string;
        sharedSecret: Buffer;
    };
    registerRequestHandlerForSecret(sharedSecret: Buffer, handler: RequestHandler): {
        destinationAccount: string;
        sharedSecret: Buffer;
    };
    deregisterRequestHandlerForSecret(sharedSecret: Buffer): void;
    protected defaultPaymentHandler(params: PaymentHandlerParams): Promise<void>;
    protected defaultRequestHandler(params: RequestHandlerParams): Promise<void>;
    protected reject(code: string, message?: string, data?: Buffer): Buffer;
    protected handleData: (data: Buffer) => Promise<Buffer>;
}
export declare function createReceiver(opts: ReceiverOpts): Promise<Receiver>;
