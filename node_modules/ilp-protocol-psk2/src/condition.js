"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const crypto = require("crypto");
const constants = require("./constants");
function dataToFulfillment(secret, data) {
    const key = hmac(secret, Buffer.from(constants.PSK_FULFILLMENT_STRING, 'utf8'));
    const fulfillment = hmac(key, data);
    return fulfillment;
}
exports.dataToFulfillment = dataToFulfillment;
function hmac(key, message) {
    const h = crypto.createHmac('sha256', key);
    h.update(message);
    return h.digest();
}
function fulfillmentToCondition(preimage) {
    const h = crypto.createHash('sha256');
    h.update(preimage);
    return h.digest();
}
exports.fulfillmentToCondition = fulfillmentToCondition;
//# sourceMappingURL=condition.js.map